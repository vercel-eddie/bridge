syntax = "proto3";

package bridge.v1;

// Message is the unit of communication through the bridge tunnel.
message Message {
  enum Protocol {
    PROTOCOL_UNSPECIFIED = 0;
    PROTOCOL_TCP = 1;
    PROTOCOL_UDP = 2;
  }

  message Address {
    string ip = 1;
    int32 port = 2;
  }

  // The address that is sending the message.
  Address source = 2;

  // The intended target address on the destination.
  Address dest = 3;

  // The payload data being tunneled.
  bytes data = 4;

  // Connection ID for multiplexing multiple connections over one tunnel.
  string connection_id = 5 [json_name = "connection_id"];

  // Set to true when the connection should be closed.
  bool close = 6;

  // Error message if something went wrong.
  string error = 7;
}
